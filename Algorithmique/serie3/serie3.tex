				% ENABLE or DISABLE font change
				% use XeLaTeX if true
\newif\ifdys
				\dystrue
				\dysfalse

\newif\ifsolutions
				\solutionstrue
				\solutionsfalse

\input{../preamble.tex}

\AdvanceDate[0]

\begin{document}
\pagestyle{fancy}
\fancyhead[L]{Seconde 13}
\fancyhead[C]{\textbf{Algorithmique : dichotomie \ifsolutions \, -- Solutions  \fi}}
\fancyhead[R]{\today}


\begin{figure}[h]
\begin{mintedbox}{python}
def f(x):
	return x**2 - 2

precision = 1e-2

def racine2(a, b):
	if b-a < precision:
		return a, b
	m = (a+b)/2
	if f(m)> 0:
		return racine2(a,m)
	return racine2(m,b)
	
a, b = racine2(1, 2)
\end{mintedbox}
\caption{Algorithme d'encadrement de $\sqrt{2}$ par dichotomie.}
\label{fig:1}
\end{figure}

\exe{
	On souhaite approximer la valeur de $\sqrt{2}$, qu'on sait solution positive de l'équation
		\[ x^2 - 2= 0. \]
	Pour cela, on implémente l'algorithme par dichotomie (figure \ref{fig:1}) vu en cours.
	\begin{enumerate}
		\item Esquisser $\C_f$ où $f(x) = x^2 - 2$ pour s'assurer que $f$ est croissante autour de $\sqrt{2}$.
		\item Pourquoi appelle-t-on la fonction avec $a = 1$ et $b=2$ ?
		\item Montrer que si $a < \sqrt2 < b$ au départ, alors l'algorithme maintient un intervalle $[a ; b]$ contenant toujours $\sqrt{2}$.
		\item Remplacer la précision par $10^{-5}, 10^{-10}, 10^{-15}, 10^{-16}$ et appeler \texttt{racine2(1,2)}.
		Que remarque-t-on ?
		 \item Montrer que, d'un appel de \texttt{racine2} à l'autre, la longueur de l'intervalle $[a ; b]$ est divisé par $2$.
		 \item Combien d'opérations sont nécessaires pour obtenir un intervalle de longueur $2^{-10}$ ? Et $2^{-n}$ ?
	\end{enumerate}
}{}

%\hrule
\newpage

\begin{figure}[h]
\begin{mintedbox}{python}
def f(x):
	return _______

precision = 1e-10

def phi(a, b):
	if b-a < ________:
		return a, b
	m = (a+b)/2
	if _______:
		return phi(a,m)
	return phi(m,b)
	
a, b = phi(__,__)
\end{mintedbox}
\caption{Algorithme d'encadrement de $\phi$ par dichotomie.}
\label{fig:2}
\end{figure}

\exe{
	On souhaite approximer la valeur du nombre d'or $\phi$, qu'on sait unique solution positive de l'équation
		\[ x^2 - x - 1 = 0. \]
	La fonction $f(x) = x^2 - x- 1$ est croissante autour de $\phi$.
	\begin{enumerate}
		\item Compléter l'algorithme par dichotomie (figure \ref{fig:2}). Avec quels paramètres appeler la fonction \texttt{phi} ?
		\item Montrer que $f(x) = \left(x - \dfrac{1+\sqrt{5}}2\right) \left(x - \dfrac{1-\sqrt{5}}2\right)$ et en déduire que $\phi = \dfrac{1+\sqrt{5}}2$.
		\item On suppose qu'on a une approximation de $\phi$ donnée par un encadrement 
			\[ a < \phi < b, \]
		de longueur $b-a = \ell$.
		
		En déduire un encadrement de $\sqrt{5}$ et la longueur de celui-ci en fonction de $\ell$.
		L'approximation de $\sqrt{5}$ donnée par l'intervalle est-elle plus ou moins précise que l'approximation de $\phi$ ?
	\end{enumerate}
}{}



\end{document}
